html(lang='en')
	head
		//- link(rel='stylesheet' type='text/css' href='https://meyerweb.com/eric/tools/css/reset/reset.css')
		link(rel='stylesheet' type='text/css' href='/styles/style.css')
		link(href='https://fonts.googleapis.com/css?family=Montserrat|Roboto', rel='stylesheet')
		title Garrett Drystore
		meta(name='viewport', content='width=device-width, initial-scale=1.0')
		meta(name='description' content='A Database for storing food goods')
		meta(name='author' content='Evan Garrett')
		meta(name='keywords' content='Database, Drystore, Evan, Garrett')
		link(rel ='shortcut icon' href='/img/favicon.ico')
	body
		if user
			div.header
				ul
					li
						form(action='/')
							button.hov Home
					li  
						form(action='/db/storeview')
							button.hov View DryStore
					li
						form(action='/db/add')
							button.hov Add Item
					li
						form(action='/insights/console')
							button.hov Insights

		if !user
			div.header
				ul
					li
						form(action='/')
							button.hov Home
					li
						form(action='/users/login')
							button.hov Login
	div.headBreaker
	input#data(type='hidden', value=items)
	h1.heading.bigHead Insights
	br
	ul.insightHeader
		li.insightHeaderLi
			a(href='/insights/console') Main
		hr
		li
			a(href='/insights/breakdown') Breakdown
		hr
		li
			a(href='/insights/console') More Analysis
	br
	br
	br
	#chartContainer(style='height: 300px; width: 100%;')
	br
	h1.heading.space Breakdown: Total Prepared Food Available per Category (in Cups)
	br
	div.breakDownCont
		div.breakDownUnit
			a(href='/insights/categorylist?search=soup')
				div.breakDownDiv#soup
			a(href='/insights/categorylist?search=entree')
				div.breakDownDiv#entree
			a(href='/insights/categorylist?search=Entree+With+Meat')
				div.breakDownDiv#entreeWithMeat
			a(href='/insights/categorylist?search=Meat+Only')
				div.breakDownDiv#MeatOnly
			a(href='/insights/categorylist?search=Beans')
				div.breakDownDiv#Beans
			a(href='/insights/categorylist?search=Cracker')
				div.breakDownDiv#Cracker
			a(href='/insights/categorylist?search=Pasta')
				div.breakDownDiv#Pasta
			a(href='/insights/categorylist?search=Potato')
				div.breakDownDiv#Potato
			a(href='/insights/categorylist?search=Rice')
				div.breakDownDiv#Rice
			a(href='/insights/categorylist?search=Vegetable')
				div.breakDownDiv#Vegetable
			a(href='/insights/categorylist?search=Breakfast+Meal')
				div.breakDownDiv#BreakfastMeal
			a(href='/insights/categorylist?search=Breakfast+Drink')
				div.breakDownDiv#BreakfastDrink
		div.breakDownUnit
			a(href='/insights/categorylist?search=Breakfast+Meat')
				div.breakDownDiv#BreakfastMeat
			a(href='/insights/categorylist?search=Eggs')
				div.breakDownDiv#Eggs
			a(href='/insights/categorylist?search=Granola')
				div.breakDownDiv#Granola
			a(href='/insights/categorylist?search=Milk')
				div.breakDownDiv#Milk
			a(href='/insights/categorylist?search=Oatmeal')
				div.breakDownDiv#Oatmeal
			a(href='/insights/categorylist?search=Yogurt')
				div.breakDownDiv#Yogurt
			a(href='/insights/categorylist?search=Fruit')
				div.breakDownDiv#Fruit
			a(href='/insights/categorylist?search=Gravy')
				div.breakDownDiv#Gravy
			a(href='/insights/categorylist?search=Sauce')
				div.breakDownDiv#Sauce
			a(href='/insights/categorylist?search=Dessert')
				div.breakDownDiv#Dessert
			a(href='/insights/categorylist?search=Spice')
				div.breakDownDiv#Spice
			a(href='/insights/categorylist?search=Drink')
				div.breakDownDiv#Drink
	br
	input#getDat(type='hidden' value=catData)
	script.
		let getDat = document.getElementById('getDat').value;
		let newDat = (JSON.parse(getDat));
		let totalQuant = 0;
		let i;
		for (i in newDat) {
			totalQuant += parseInt(newDat[i]);
		}

		let divi = 100/totalQuant;
		
		let percentize = (value) => {
			let mittel = value*divi
			return mittel.toFixed(2)
		}
		window.onload = function() {

		var chart = new CanvasJS.Chart("chartContainer", {
			theme: "light2", // "light1", "light2", "dark1", "dark2"
			exportEnabled: true,
			animationEnabled: true,
			title: {
				text: "Drystore Renderable Contents"
			},
			data: [{
				type: "pie",
				startAngle: 25,
				toolTipContent: "<b>{label}</b>: {y}%",
				showInLegend: "true",
				legendText: "{label}",
				indexLabelFontSize: 16,
				indexLabel: "{label} - {y}%",
				dataPoints: [
					{ y: percentize(newDat.Beans), label: "Beans" },
					{ y: percentize(newDat.BreakfastDrink), label: "Breakfast Drink" },
					{ y: percentize(newDat.BreakfastMeal), label: "Breakfast Meals" },
					{ y: percentize(newDat.Soup), label: "Soup" },
					{ y: percentize(newDat.BreakfastMeal), label: "Breakfast Meals" },
					{ y: percentize(newDat.BreakfastMeat), label: "Breakfast Meat" },
					{ y: percentize(newDat.Cracker), label: "Crackers" },
					{ y: percentize(newDat.Dessert), label: "Dessert" },
					{ y: percentize(newDat.Drink), label: "Drink" },
					{ y: percentize(newDat.Eggs), label: "Eggs" },
					{ y: percentize(newDat.Entree), label: "Entree" },
					{ y: percentize(newDat.EntreeWithMeat), label: "Entrees With Meat" },
					{ y: percentize(newDat.Fruit), label: "Fruit" },				
					{ y: percentize(newDat.Granola), label: "Granola" },
					{ y: percentize(newDat.Gravy), label: "Gravy" },
					{ y: percentize(newDat.MeatOnly), label: "Meat Only" },
					{ y: percentize(newDat.Milk), label: "Milk" },
					{ y: percentize(newDat.Oatmeal), label: "Oatmeal" },
					{ y: percentize(newDat.Pasta), label: "Pasta" },
					{ y: percentize(newDat.Potato), label: "Potato" },
					{ y: percentize(newDat.Rice), label: "Rice" },
					{ y: percentize(newDat.Sauce), label: "Sauce" },
					{ y: percentize(newDat.Spice), label: "Spice" },
					{ y: percentize(newDat.Vegetable), label: "Vegetable" },
					{ y: percentize(newDat.Yogurt), label: "Yogurt" },
					{ y: 0, label: "Others" }
				]
			}]
		});
		chart.render();

		}
	script(src="https://canvasjs.com/assets/script/canvasjs.min.js")
	script.
		let allItemData = document.getElementById('data');
		let items = JSON.parse(allItemData.value);

		let catTotal = {};
		catTotal.Soup = 0;
		catTotal.Entree = 0;
		catTotal.EntreeWithMeat = 0;
		catTotal.MeatOnly = 0;
		catTotal.Beans = 0;
		catTotal.Cracker = 0;
		catTotal.Pasta = 0;
		catTotal.Potato = 0;
		catTotal.Rice = 0;
		catTotal.Vegetable = 0;
		catTotal.BreakfastMeal = 0;
		catTotal.BreakfastDrink = 0;
		catTotal.BreakfastMeat= 0;
		catTotal.Eggs = 0;
		catTotal.Granola = 0;
		catTotal.Milk = 0;
		catTotal.Oatmeal= 0;
		catTotal.Yogurt = 0;
		catTotal.Fruit = 0;
		catTotal.Gravy = 0;
		catTotal.Sauce = 0;
		catTotal.Dessert = 0;
		catTotal.Spice= 0;
		catTotal.Drink= 0;
		for (i=0;i<items.length;i++) {
			if (items[i].category == 'Soup') {
				catTotal.Soup+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Entree') {
				catTotal.Entree+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Entree with Meat') {
				catTotal.EntreeWithMeat+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Meat Only') {
				catTotal.MeatOnly+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Beans') {
				catTotal.Beans+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Cracker') {
				catTotal.Cracker+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Pasta') {
				catTotal.Pasta+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Potato') {
				catTotal.Potato+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Rice') {
				catTotal.Rice+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Vegetable') {
				catTotal.Vegetable+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Breakfast Meal') {
				catTotal.BreakfastMeal+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Breakfast Drink') {
				catTotal.BreakfastDrink+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Breakfast Meat') {
				catTotal.BreakfastMeat+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Eggs') {
				catTotal.Eggs+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Granola') {
				catTotal.Granola+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Milk') {
				catTotal.Milk+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Oatmeal') {
				catTotal.Oatmeal+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Yogurt') {
				catTotal.Yogurt+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Fruit') {
				catTotal.Fruit+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Gravy') {
				catTotal.Gravy+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Sauce') {
				catTotal.Sauce+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Dessert') {
				catTotal.Dessert+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Spice') {
				catTotal.Spice+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
			if (items[i].category == 'Drink') {
				catTotal.Drink+= (items[i].quantity * items[i].servings * items[i].preparedserving);
				}
		}
		
		document.getElementById('soup').innerHTML = '<h1>Soups:</h1> ' + catTotal.Soup + ' cups';
		document.getElementById('entree').innerHTML = '<h1>Entree:</h1> ' + catTotal.Entree + ' cups';
		document.getElementById('entreeWithMeat').innerHTML = '<h1>Entree with Meat:</h1> ' + catTotal.EntreeWithMeat + ' cups';
		document.getElementById('MeatOnly').innerHTML = '<h1>Meat Only:</h1> ' + catTotal.MeatOnly + ' cups';
		document.getElementById('Beans').innerHTML = '<h1>Beans:</h1> ' + catTotal.Beans + ' cups';
		document.getElementById('Cracker').innerHTML = '<h1>Crackers:</h1> ' + catTotal.Cracker + ' cups';
		document.getElementById('Pasta').innerHTML = '<h1>Pasta:</h1> ' + catTotal.Pasta + ' cups';
		document.getElementById('Potato').innerHTML = '<h1>Potato:</h1> ' + catTotal.Potato + ' cups';
		document.getElementById('Rice').innerHTML = '<h1>Rice:</h1> ' + catTotal.Rice + ' cups';
		document.getElementById('Vegetable').innerHTML = '<h1>Vegetable:</h1> ' + catTotal.Vegetable + ' cups';
		document.getElementById('BreakfastMeal').innerHTML = '<h1>Breakfast Meal:</h1> ' + catTotal.BreakfastMeal + ' cups';
		document.getElementById('BreakfastDrink').innerHTML = '<h1>Breakfast Drink:</h1> ' + catTotal.BreakfastDrink + ' cups';
		document.getElementById('BreakfastMeat').innerHTML = '<h1>Breakfast Meat:</h1> ' + catTotal.BreakfastMeat + ' cups';
		document.getElementById('Eggs').innerHTML = '<h1>Eggs:</h1> ' + catTotal.Eggs + ' cups';
		document.getElementById('Granola').innerHTML = '<h1>Granola:</h1> ' + catTotal.Granola + ' cups';
		document.getElementById('Milk').innerHTML = '<h1>Milk:</h1> ' + catTotal.Milk + ' cups';
		document.getElementById('Oatmeal').innerHTML = '<h1>Oatmeal:</h1> ' + catTotal.Oatmeal + ' cups';
		document.getElementById('Yogurt').innerHTML = '<h1>Yogurt:</h1> ' + catTotal.Yogurt + ' cups';
		document.getElementById('Fruit').innerHTML = '<h1>Fruit:</h1> ' + catTotal.Fruit + ' cups';
		document.getElementById('Gravy').innerHTML = '<h1>Gravy:</h1> ' + catTotal.Gravy + ' cups';
		document.getElementById('Sauce').innerHTML = '<h1>Sauce:</h1> ' + catTotal.Sauce + ' cups';
		document.getElementById('Dessert').innerHTML = '<h1>Dessert:</h1> ' + catTotal.Dessert + ' cups';
		document.getElementById('Spice').innerHTML = '<h1>Spice:</h1> ' + catTotal.Spice + ' cups';
		document.getElementById('Drink').innerHTML = '<h1>Drink:</h1> ' + catTotal.Drink + ' cups';